
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>mvpy.model_selection package &#8212; MVPy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/colors.css?v=cc94ab7d" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/custom.css?v=eec3fc85" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'source/mvpy.model_selection';</script>
    <script src="../_static/scripts/dropdown.js?v=5b9cef8c"></script>
    <script src="../_static/scripts/version-switcher.js?v=6ebe4089"></script>
    <script src="../_static/scripts/sg_plotly_resize.js?v=dc4a1e18"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/mvpy-icon.png" class="logo__image only-light" alt=""/>
    <img src="../_static/mvpy-icon.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">MVPy</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/FabulousFabs/mvpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/FabulousFabs/mvpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="mvpy.crossvalidation.html">mvpy.crossvalidation package</a></li>
<li class="toctree-l1"><a class="reference internal" href="mvpy.dataset.html">mvpy.dataset package</a></li>
<li class="toctree-l1"><a class="reference internal" href="mvpy.estimators.html">mvpy.estimators package</a></li>
<li class="toctree-l1"><a class="reference internal" href="mvpy.math.html">mvpy.math package</a></li>
<li class="toctree-l1"><a class="reference internal" href="mvpy.metrics.html">mvpy.metrics package</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">mvpy.model_selection package</a></li>
<li class="toctree-l1"><a class="reference internal" href="mvpy.preprocessing.html">mvpy.preprocessing package</a></li>
<li class="toctree-l1"><a class="reference internal" href="mvpy.signal.html">mvpy.signal package</a></li>
<li class="toctree-l1"><a class="reference internal" href="mvpy.utilities.html">mvpy.utilities package</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">mvpy.model_selection package</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="mvpy-model-selection-package">
<h1>mvpy.model_selection package<a class="headerlink" href="#mvpy-model-selection-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-mvpy.model_selection.hierarchical">
<span id="mvpy-model-selection-hierarchical-module"></span><h2>mvpy.model_selection.hierarchical module<a class="headerlink" href="#module-mvpy.model_selection.hierarchical" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mvpy.model_selection.hierarchical.Hierarchical">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mvpy.model_selection.hierarchical.</span></span><span class="sig-name descname"><span class="pre">Hierarchical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mvpy.crossvalidation.html#mvpy.crossvalidation.validator.Validator" title="mvpy.crossvalidation.validator.Validator"><span class="pre">Validator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_underspecified</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/hierarchical.py#L209"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.hierarchical.Hierarchical" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implements a hierarchical scoring procedure over all feature permutations in <span class="math notranslate nohighlight">\(X\)</span> describing <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>When modeling outcomes <span class="math notranslate nohighlight">\(y\)</span>, a common question to ask is what specific combination
of predictors in <span class="math notranslate nohighlight">\(X\)</span> explains the observed data best. One way to tackle this question
is to iteratively cross-validate the scoring of predictions <span class="math notranslate nohighlight">\(\hat{y}\)</span> from each 
possible feature combination in <span class="math notranslate nohighlight">\(X\)</span>. For example, if we have three features in 
<span class="math notranslate nohighlight">\(X\)</span>, we would model y as a function of feature combinations <span class="math notranslate nohighlight">\(\left[(0), (1), (2), (0, 1), (0, 2), (1, 2), (0, 1, 2)\right]\)</span>
such that we can now compare how well each individual predictor and combination of 
predictors explain the data.</p>
<p>This class implements precisely this hierarchical modeling procedure, but allows creation
of groups of predictors. For example, we might have several predictors in <span class="math notranslate nohighlight">\(X\)</span> that,
together, form some kind of baseline. We might then specify:</p>
<div class="math notranslate nohighlight">
\[\begin{split}G = \begin{bmatrix}
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}\end{split}\]</div>
<p>to signal that there are three total groups of predictors that we want to permute together,
the first one including predictors 1-3, and the following two including one novel predictor 
each. <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hierarchical</span></code></a> would now compute <span class="math notranslate nohighlight">\(2^3 - 1\)</span> 
combinations instead of the full <span class="math notranslate nohighlight">\(2^6 - 1\)</span> combinations. As described before, this
yields the feature combinations <span class="math notranslate nohighlight">\(\left[(0), (1), (2), (0, 1), (0, 2), (1, 2), (0, 1, 2)\right]\)</span>
where feature <span class="math notranslate nohighlight">\((0,)\)</span> groups predictors <span class="math notranslate nohighlight">\(\{0, 1, 2\}\)</span>.</p>
<p>Observe, however, that this now means that the permutations include those permutations where
the baseline predictors are not included in all other models–for example, <span class="math notranslate nohighlight">\((1,)\)</span> which
would evaluate to <span class="math notranslate nohighlight">\([0, 0, 0, 1, 0]\)</span>. If we want to enforce that all models include the 
baseline, we should make them part of every other group:</p>
<div class="math notranslate nohighlight">
\[\begin{split}G = \begin{bmatrix}
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
    1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 1
\end{bmatrix}\end{split}\]</div>
<p>The backend will automatically remove duplicates, leaving us with only the contrasts that are
of interest to us <span class="math notranslate nohighlight">\(\left[(0,), (0, 1), (0, 2), (0, 1, 2)\right]\)</span> or, expressed as
boolean masks:</p>
<div class="math notranslate nohighlight">
\[\begin{split}M = \begin{bmatrix}
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
    1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 1 \\
    1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
\end{bmatrix}\end{split}\]</div>
<p>In code, you can confirm the desired grouping in <code class="xref py py-attr docutils literal notranslate"><span class="pre">group_</span></code>,
the resulting feature combinations in <code class="xref py py-attr docutils literal notranslate"><span class="pre">set_</span></code> and the masks
that were applied in <code class="xref py py-attr docutils literal notranslate"><span class="pre">mask_</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This performs <span class="math notranslate nohighlight">\(k\left(2^p - 1\right)\)</span> individual model fits where <span class="math notranslate nohighlight">\(k\)</span> is the
total number of cross-validation steps and <span class="math notranslate nohighlight">\(p\)</span> is the number of unique groups of 
predictors. For large <span class="math notranslate nohighlight">\(p\)</span>, this becomes exponentially more expensive to solve. If you
are interested in the unique contribution of each feature rather than separate estimates for
all combinations, consider using <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shapley</span></code></a> instead.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The default behaviour of this class is to check whether all predictors in <span class="math notranslate nohighlight">\(X\)</span> appear in
the group specification <code class="xref py py-attr docutils literal notranslate"><span class="pre">groups</span></code> at least once.
If this is not the case, the class will <code class="docutils literal notranslate"><span class="pre">raise</span></code> an exception. If you would like to mutate
this behaviour to either ignore or warn about these cases only, you may want to supply the 
corresponding <code class="xref py py-attr docutils literal notranslate"><span class="pre">on_underspecified</span></code> value.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When specifying <code class="docutils literal notranslate"><span class="pre">n_jobs</span></code> here, be careful not to specify any number of jobs
in the model or underlying validator. Otherwise, this will lead to a situation 
where individual jobs each try to initialise more low-level jobs, severely hurting 
performance.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>validator</strong><span class="classifier">mvpy.crossvalidation.Validator</span></dt><dd><p>The validator object that should be used in this procedure.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>How many jobs should be used to parallelise the hierarchical fitting procedure?</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int | bool, default=False</span></dt><dd><p>Should progress be reported verbosely?</p>
</dd>
<dt><strong>on_underspecified</strong><span class="classifier">{‘raise’, ‘warn’, ‘ignore’}, default=’raise’</span></dt><dd><p>If we detect an underspecified grouping–i.e., not all available predictors are used–to what level should we escalate things?</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>validator</strong><span class="classifier">mvpy.crossvalidation.Validator</span></dt><dd><p>The validator object that should be used in this procedure.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>How many jobs should be used to parallelise the hierarchical fitting procedure?</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int | bool, default=False</span></dt><dd><p>Should progress be reported verbosely?</p>
</dd>
<dt><strong>on_underspecified</strong><span class="classifier">{‘raise’, ‘warn’, ‘ignore’}, default=’raise’</span></dt><dd><p>If we detect an underspecified grouping–i.e., not all available predictors are used–to what level should we escalate things?</p>
</dd>
<dt><strong>validator_</strong><span class="classifier">List[mvpy.crossvalidation.Validator]</span></dt><dd><p>A list of all fitted validators.</p>
</dd>
<dt><strong>score_</strong><span class="classifier">np.ndarray | torch.Tensor | Dict[str, np.ndarray] | Dict[str, torch.Tensor]</span></dt><dd><p>The hierarchical scores of shape <code class="docutils literal notranslate"><span class="pre">(n_sets,</span> <span class="pre">n_cv[,</span> <span class="pre">...])</span></code> or a dictionary containing each individual <a class="reference internal" href="../modules/generated/mvpy.metrics.Metric.html#mvpy.metrics.Metric" title="mvpy.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a>.</p>
</dd>
<dt><strong>mask_</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>A matrix where each row corresponds to one boolean mask used to fit one validator.</p>
</dd>
<dt><strong>group_</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>A matrix where each row corresponds to the boolean mask for one group.</p>
</dd>
<dt><strong>group_id_: np.ndarray | torch.Tensor</strong></dt><dd><p>A vector containing group identifiers used in sets.</p>
</dd>
<dt><strong>set_</strong><span class="classifier">List[Tuple[int]]</span></dt><dd><p>A list including all group combinations that were tested.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#module-mvpy.model_selection.shapley_score" title="mvpy.model_selection.shapley_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.shapley_score</span></code></a>, <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.Shapley</span></code></a></dt><dd><p>An alternative scoring method computing unique contributions of each feature rather than the full permutation.</p>
</dd>
<dt><a class="reference internal" href="#module-mvpy.model_selection.hierarchical_score" title="mvpy.model_selection.hierarchical_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.hierarchical_score</span></code></a></dt><dd><p>A shorthand for fitting this class.</p>
</dd>
<dt><a class="reference internal" href="../modules/generated/mvpy.crossvalidation.Validator.html#mvpy.crossvalidation.Validator" title="mvpy.crossvalidation.Validator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.crossvalidation.Validator</span></code></a></dt><dd><p>The cross-validation object required by <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hierarchical</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Currently this does not automatically select the best model for you. Instead,
it will return all scores, leaving further decisions up to you. This is because, 
for most applications, the scores of all permutations are actually of interest
and may need to be reported.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If multiple values are supplied for <code class="docutils literal notranslate"><span class="pre">metric</span></code>, this class will
produce a dictionary of <code class="docutils literal notranslate"><span class="pre">{Metric.name:</span> <span class="pre">score,</span> <span class="pre">...}</span></code> rather than
a stacked array. This is to provide consistency across cases where
metrics may or may not differ in their output shapes.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_meeg_continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeDelayed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.crossvalidation</span><span class="w"> </span><span class="kn">import</span> <span class="n">Validator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">Hierarchical</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_meeg_continuous</span><span class="p">(</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup pipeline for estimation of multivariate temporal response functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trf</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Scaler</span><span class="p">()</span><span class="o">.</span><span class="n">to_torch</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">TimeDelayed</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> 
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">alphas</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup validator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">trf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup groups of predictors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">],</span> 
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># score predictors hierarchically</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hierarchical</span> <span class="o">=</span> <span class="n">Hierarchical</span><span class="p">(</span><span class="n">validator</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hierarchical</span><span class="o">.</span><span class="n">score_</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.size([4, 5, 64, 400])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mvpy.model_selection.hierarchical.Hierarchical.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mvpy.model_selection.hierarchical.Hierarchical" title="mvpy.model_selection.hierarchical.Hierarchical"><span class="pre">Hierarchical</span></a></span></span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/hierarchical.py#L413"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.hierarchical.Hierarchical.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit all models in a hierarchical manner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The input data of arbitray shape.</p>
</dd>
<dt><strong>y</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The output data of arbitrary shape.</p>
</dd>
<dt><strong>groups</strong><span class="classifier">Optional[List | np.ndarray | torch.Tensor], default=None</span></dt><dd><p>Matrix describing all groups of interest of shape <code class="docutils literal notranslate"><span class="pre">(n_groups,</span> <span class="pre">n_predictors)</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will default to the identity matrix of <code class="docutils literal notranslate"><span class="pre">(n_predictors,</span> <span class="pre">n_predictors)</span></code>.</p>
</dd>
<dt><strong>dim</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>The dimension in <span class="math notranslate nohighlight">\(X\)</span> that describes the predictors. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will assume <code class="docutils literal notranslate"><span class="pre">-1</span></code> for 2D data and <code class="docutils literal notranslate"><span class="pre">-2</span></code> otherwise.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hierarchical</strong><span class="classifier">mvpy.model_selection.Hierarchical</span></dt><dd><p>The fitted hierarchical model selector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mvpy.model_selection.hierarchical.check_dims_and_groups_">
<span class="sig-prename descclassname"><span class="pre">mvpy.model_selection.hierarchical.</span></span><span class="sig-name descname"><span class="pre">check_dims_and_groups_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_underspecified</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/hierarchical.py#L17"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.hierarchical.check_dims_and_groups_" title="Link to this definition">#</a></dt>
<dd><p>Check dimension and groups and create corresponding sets and masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The input data of arbitray shape.</p>
</dd>
<dt><strong>y</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The output data of arbitrary shape.</p>
</dd>
<dt><strong>groups</strong><span class="classifier">Optional[List | np.ndarray | torch.Tensor], default=None</span></dt><dd><p>Matrix describing all groups of interest of shape <code class="docutils literal notranslate"><span class="pre">(n_groups,</span> <span class="pre">n_predictors)</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will default to the identity matrix of <code class="docutils literal notranslate"><span class="pre">(n_predictors,</span> <span class="pre">n_predictors)</span></code>.</p>
</dd>
<dt><strong>dim</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>The dimension in <span class="math notranslate nohighlight">\(X\)</span> that describes the predictors. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will assume <code class="docutils literal notranslate"><span class="pre">-1</span></code> for 2D data and <code class="docutils literal notranslate"><span class="pre">-2</span></code> otherwise.</p>
</dd>
<dt><strong>on_underspecified</strong><span class="classifier">{‘raise’, ‘warn’, ‘ignore’}, default=’raise’</span></dt><dd><p>If we detect an underspecified grouping–i.e., not all available predictors are used–to what level should we escalate things?</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>dim</strong><span class="classifier">int</span></dt><dd><p>The dimension along which groups exist.</p>
</dd>
<dt><strong>group_ids</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>Vector containing group identifiers.</p>
</dd>
<dt><strong>sets</strong><span class="classifier">List[Tuple[int]]</span></dt><dd><p>List containing tuples of group identifiers, together forming all combinations.</p>
</dd>
<dt><strong>masks</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The masks corresponding to each feature combination in sets.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mvpy.model_selection.hierarchical.fit_validator_">
<span class="sig-prename descclassname"><span class="pre">mvpy.model_selection.hierarchical.</span></span><span class="sig-name descname"><span class="pre">fit_validator_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mvpy.crossvalidation.html#mvpy.crossvalidation.validator.Validator" title="mvpy.crossvalidation.validator.Validator"><span class="pre">Validator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/hierarchical.py#L150"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.hierarchical.fit_validator_" title="Link to this definition">#</a></dt>
<dd><p>Fit an individual validator object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>validator</strong><span class="classifier">mvpy.crossvalidation.Validator</span></dt><dd><p>The validator object to be fit. Note that this is automatically cloned here.</p>
</dd>
<dt><strong>X</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The input data of arbitrary shape.</p>
</dd>
<dt><strong>y</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The output data of arbitrary shape.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The mask to apply to the input data.</p>
</dd>
<dt><strong>dim</strong><span class="classifier">int</span></dt><dd><p>The dimension along which to apply the mask.</p>
</dd>
<dt><strong>i</strong><span class="classifier">int</span></dt><dd><p>The identifier to return.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>results</strong><span class="classifier">Dict</span></dt><dd><dl class="simple">
<dt>A dictionary containing the results:</dt><dd><dl class="simple">
<dt>i<span class="classifier">int</span></dt><dd><p>The identifier for this validator.</p>
</dd>
<dt>validator<span class="classifier">mvpy.crossvalidation.Validator</span></dt><dd><p>The fitted validator.</p>
</dd>
<dt>score<span class="classifier">np.ndarray | torch.Tensor | Dict[str, np.ndarray] | Dict[str, torch.Tensor]</span></dt><dd><p>The score of the validator.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<p>Configure global settings and get information about the working environment.</p>
<p>The torch package contains data structures for multi-dimensional</p>
<p>Python part of the warnings subsystem.</p>
</section>
<section id="module-mvpy.model_selection.hierarchical_score">
<span id="mvpy-model-selection-hierarchical-score-module"></span><h2>mvpy.model_selection.hierarchical_score module<a class="headerlink" href="#module-mvpy.model_selection.hierarchical_score" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mvpy.model_selection.hierarchical_score.hierarchical_score">
<span class="sig-prename descclassname"><span class="pre">mvpy.model_selection.hierarchical_score.</span></span><span class="sig-name descname"><span class="pre">hierarchical_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BaseEstimator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mvpy.metrics.html#mvpy.metrics.metric.Metric" title="mvpy.metrics.metric.Metric"><span class="pre">Metric</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="mvpy.metrics.html#mvpy.metrics.metric.Metric" title="mvpy.metrics.metric.Metric"><span class="pre">Metric</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_hierarchical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs_validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mvpy.model_selection.hierarchical.Hierarchical" title="mvpy.model_selection.hierarchical.Hierarchical"><span class="pre">Hierarchical</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/hierarchical_score.py#L13"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.hierarchical_score.hierarchical_score" title="Link to this definition">#</a></dt>
<dd><p>Implements a shorthand for hierarchical scoring over all feature permutations in <span class="math notranslate nohighlight">\(X\)</span> describing <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>This function acts as a shorthand for <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hierarchical</span></code></a> 
where it will automatically create and fit all permutations of the predictors specified
in <span class="math notranslate nohighlight">\(X\)</span> following a hierarchical procedure. Returns either only the output scores
or, if <code class="docutils literal notranslate"><span class="pre">return_hierarchical</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, both the fitted hierarchical object and
the scores in a tuple.</p>
<p>For more information, please consult <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hierarchical</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This performs <span class="math notranslate nohighlight">\(k\left(2^p - 1\right)\)</span> individual model fits where <span class="math notranslate nohighlight">\(k\)</span> is the
total number of cross-validation steps and <span class="math notranslate nohighlight">\(p\)</span> is the number of unique groups of 
predictors. For large <span class="math notranslate nohighlight">\(p\)</span>, this becomes exponentially more expensive to solve. If you
are interested in the unique contribution of each feature rather than separate estimates for
all combinations, consider using <a class="reference internal" href="#module-mvpy.model_selection.shapley_score" title="mvpy.model_selection.shapley_score"><code class="xref py py-class docutils literal notranslate"><span class="pre">shapley_score</span></code></a> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">sklearn.pipeline.Pipeline | sklearn.base.BaseEstimator</span></dt><dd><p>The model to fit and score. Can be either a pipeline or estimator object.</p>
</dd>
<dt><strong>X</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The input data of arbitrary shape.</p>
</dd>
<dt><strong>y</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The output data of arbitrary shape.</p>
</dd>
<dt><strong>groups</strong><span class="classifier">Optional[List | np.ndarray | torch.Tensor], default=None</span></dt><dd><p>Matrix describing all groups of interest of shape <code class="docutils literal notranslate"><span class="pre">(n_groups,</span> <span class="pre">n_predictors)</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will default to the identity matrix <code class="docutils literal notranslate"><span class="pre">(n_predictors,</span> <span class="pre">n_predictors)</span></code>.</p>
</dd>
<dt><strong>dim</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>The dimension in <span class="math notranslate nohighlight">\(X\)</span> that describes the predictors. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will assume <code class="docutils literal notranslate"><span class="pre">-1</span></code> for 2D data and <code class="docutils literal notranslate"><span class="pre">-2</span></code> otherwise.</p>
</dd>
<dt><strong>cv</strong><span class="classifier">int | Any, default=5</span></dt><dd><p>The cross-validation procedure to follow. Either an object exposing a <code class="docutils literal notranslate"><span class="pre">split()</span></code> method, such as :py:class`~mvpy.crossvalidation.KFold`, or an integer specifying the number of folds to use in <code class="xref py py-class docutils literal notranslate"><span class="pre">KFold</span></code>.</p>
</dd>
<dt><strong>metric</strong><span class="classifier">Optional[mvpy.metrics.Metric, Tuple[mvpy.metrics.Metric]], default=None</span></dt><dd><p>The metric to use for scoring. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will default to the <code class="docutils literal notranslate"><span class="pre">score()</span></code> method exposed by <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p>
</dd>
<dt><strong>return_hierarchical</strong><span class="classifier">bool, default=True</span></dt><dd><p>Should the underlying <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hierarchical</span></code></a> object be returned?</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>How many jobs should be used to parallelise the hierarchical fitting procedure?</p>
</dd>
<dt><strong>n_jobs_validator</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>How many jobs should be used to parallelise the cross-validation procedure?</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int | bool, default=False</span></dt><dd><p>Should progress be reported verbosely?</p>
</dd>
<dt><strong>verbose_validator</strong><span class="classifier">int | bool, default=False</span></dt><dd><p>Should progress in individual <a class="reference internal" href="../modules/generated/mvpy.crossvalidation.Validator.html#mvpy.crossvalidation.Validator" title="mvpy.crossvalidation.Validator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Validator</span></code></a> objects be reported verbosely?</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hierarchical</strong><span class="classifier">Optional[mvpy.model_selection.Hierarchical]</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">return_hierarchical</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the underlying <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hierarchical</span></code></a> object.</p>
</dd>
<dt><strong>score</strong><span class="classifier">np.ndarray | torch.Tensor | Dict[str, np.ndarray] | Dict[str, torch.Tensor]</span></dt><dd><p>The all hierarchical scores of shape <code class="docutils literal notranslate"><span class="pre">(n_sets,</span> <span class="pre">n_cv[,</span> <span class="pre">...])</span></code> or a dictionary containing each individual <a class="reference internal" href="../modules/generated/mvpy.metrics.Metric.html#mvpy.metrics.Metric" title="mvpy.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#module-mvpy.model_selection.shapley_score" title="mvpy.model_selection.shapley_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.shapley_score</span></code></a>, <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.Shapley</span></code></a></dt><dd><p>An alternative scoring method computing unique contributions of each feature rather than the full permutation.</p>
</dd>
<dt><a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.Hierarchical</span></code></a></dt><dd><p>The underlying hierarchical scoring object.</p>
</dd>
<dt><a class="reference internal" href="../modules/generated/mvpy.crossvalidation.Validator.html#mvpy.crossvalidation.Validator" title="mvpy.crossvalidation.Validator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.crossvalidation.Validator</span></code></a></dt><dd><p>The cross-validation objects used in <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hierarchical</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Currently this does not automatically select the best model for you. Instead,
it will return all scores, leaving further decisions up to you. This is because, 
for most applications, the scores of all permutations are actually of interest
and may need to be reported.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If multiple values are supplied for <code class="docutils literal notranslate"><span class="pre">metric</span></code>, this function will
output a dictionary of <code class="docutils literal notranslate"><span class="pre">{Metric.name:</span> <span class="pre">score,</span> <span class="pre">...}</span></code> rather than
a stacked array. This is to provide consistency across cases where
metrics may or may not differ in their output shapes.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When specifying <code class="docutils literal notranslate"><span class="pre">n_jobs</span></code> here, be careful not to specify any number of jobs
in the model or any <code class="docutils literal notranslate"><span class="pre">n_jobs_validator</span></code>. Otherwise, this will lead to a situation 
where individual jobs each try to initialise more low-level jobs, severely hurting 
performance.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_meeg_continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeDelayed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">hierarchical_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_meeg_continuous</span><span class="p">(</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup pipeline for estimation of multivariate temporal response functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trf</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Scaler</span><span class="p">()</span><span class="o">.</span><span class="n">to_torch</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">TimeDelayed</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> 
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">alphas</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup groups of predictors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">],</span> 
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># score predictors hierarchically</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hierarchical</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">hierarchical_score</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">trf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.size([4, 5, 64, 400])</span>
</pre></div>
</div>
</dd></dl>

<p>Configure global settings and get information about the working environment.</p>
<p>The torch package contains data structures for multi-dimensional</p>
</section>
<section id="module-mvpy.model_selection.shapley">
<span id="mvpy-model-selection-shapley-module"></span><h2>mvpy.model_selection.shapley module<a class="headerlink" href="#module-mvpy.model_selection.shapley" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mvpy.model_selection.shapley.Shapley">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mvpy.model_selection.shapley.</span></span><span class="sig-name descname"><span class="pre">Shapley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mvpy.crossvalidation.html#mvpy.crossvalidation.validator.Validator" title="mvpy.crossvalidation.validator.Validator"><span class="pre">Validator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_permutations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_underspecified</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/shapley.py#L184"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.shapley.Shapley" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implements a Shapley value scoring procedure over all feature permutations in <span class="math notranslate nohighlight">\(X\)</span> describing <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>When modeling outcomes <span class="math notranslate nohighlight">\(y\)</span>, a common question to ask is to what degree individual 
predictors in <span class="math notranslate nohighlight">\(X\)</span> contribute to <span class="math notranslate nohighlight">\(y\)</span>. To do this, we group predictors according
to <code class="xref py py-attr docutils literal notranslate"><span class="pre">groups</span></code> that may, for example, specify:</p>
<div class="math notranslate nohighlight">
\[\begin{split}G = \begin{bmatrix}
    1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}\end{split}\]</div>
<p>Or, in other words, here we have three groups of predictors. To compute Shapley values, we
always assume that group zero (in this case, including the first three predictors), is some
baseline, relative to which we measure the contribution of other predictors. If no such baseline 
exists, it should simply be an intercept predictor. Next, we perform <code class="xref py py-attr docutils literal notranslate"><span class="pre">n_permutations</span></code>
where we fit and score the zero model, then loop over a permutation of our other predictors that
we add one by one, measuring how they affect the outcome score relative to our last fitted model.</p>
<p>By repeating this procedure many times, we obtain Shapley values for each predictor that represent
the fair contribution of each predictor to outcome scores, invariant of the order in which they
may be included. The first score will always correspond to the full baseline performance, whereas
the others are relative improvements over baseline.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This performs <span class="math notranslate nohighlight">\(n k p\)</span> model fits where <span class="math notranslate nohighlight">\(n\)</span> is the number of permutations, <span class="math notranslate nohighlight">\(k\)</span> 
is the total number of cross-validation steps and <span class="math notranslate nohighlight">\(p\)</span> is the number of unique groups of
predictors. For large <span class="math notranslate nohighlight">\(p\)</span> or <span class="math notranslate nohighlight">\(n\)</span>, this becomes expensive to solve.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The default behaviour of this class is to check whether all predictors in <span class="math notranslate nohighlight">\(X\)</span> appear in
the group specification <code class="xref py py-attr docutils literal notranslate"><span class="pre">groups</span></code> at least once.
If this is not the case, the class will <code class="docutils literal notranslate"><span class="pre">raise</span></code> an exception. If you would like to mutate
this behaviour to either ignore or warn about these cases only, you may want to supply the 
corresponding <code class="xref py py-attr docutils literal notranslate"><span class="pre">on_underspecified</span></code> value.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When specifying <code class="docutils literal notranslate"><span class="pre">n_jobs</span></code> here, be careful not to specify any number of jobs
in the model or underlying validator. Otherwise, this will lead to a situation 
where individual jobs each try to initialise more low-level jobs, severely hurting 
performance.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>validator</strong><span class="classifier">mvpy.crossvalidation.Validator</span></dt><dd><p>The validator object that should be used in this procedure.</p>
</dd>
<dt><strong>n_permutations</strong><span class="classifier">int, default=10</span></dt><dd><p>How many permutations should we run? A higher number of permutations yields better estimates. Generally, the higher the number of predictor groups, the higher the number of permutations used.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>How many jobs should be used to parallelise the hierarchical fitting procedure?</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int | bool, default=False</span></dt><dd><p>Should progress be reported verbosely?</p>
</dd>
<dt><strong>on_underspecified</strong><span class="classifier">{‘raise’, ‘warn’, ‘ignore’}, default=’raise’</span></dt><dd><p>If we detect an underspecified grouping–i.e., not all available predictors are used–to what level should we escalate things?</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>validator</strong><span class="classifier">mvpy.crossvalidation.Validator</span></dt><dd><p>The validator object that should be used in this procedure.</p>
</dd>
<dt><strong>n_permutations</strong><span class="classifier">int, default=10</span></dt><dd><p>How many permutations should we run? A higher number of permutations yields better estimates. Generally, the higher the number of predictor groups, the higher the number of permutations used.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>How many jobs should be used to parallelise the hierarchical fitting procedure?</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int | bool, default=False</span></dt><dd><p>Should progress be reported verbosely?</p>
</dd>
<dt><strong>on_underspecified</strong><span class="classifier">{‘raise’, ‘warn’, ‘ignore’}, default=’raise’</span></dt><dd><p>If we detect an underspecified grouping–i.e., not all available predictors are used–to what level should we escalate things?</p>
</dd>
<dt><strong>validator_</strong><span class="classifier">List[List[mvpy.crossvalidation.Validator]]</span></dt><dd><p>A list containing, per permutation, another list containing Validators for each model group, ordered by group identity.</p>
</dd>
<dt><strong>score_</strong><span class="classifier">np.ndarray | torch.Tensor | Dict[str, np.ndarray] | Dict[str, torch.Tensor]</span></dt><dd><p>The shapley scores of shape <code class="docutils literal notranslate"><span class="pre">(n_permutations,</span> <span class="pre">n_sets,</span> <span class="pre">n_cv[,</span> <span class="pre">...])</span></code> or a dictionary containing each individual <a class="reference internal" href="../modules/generated/mvpy.metrics.Metric.html#mvpy.metrics.Metric" title="mvpy.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a>.</p>
</dd>
<dt><strong>order_</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>A matrix containing the order in which groups were added to the baseline group of shape <code class="docutils literal notranslate"><span class="pre">(n_permutations,</span> <span class="pre">n_groups</span> <span class="pre">-</span> <span class="pre">1)</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#module-mvpy.model_selection.hierarchical_score" title="mvpy.model_selection.hierarchical_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.hierarchical_score</span></code></a>, <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.Hierarchical</span></code></a></dt><dd><p>An alternative scoring method computing the full permutation over features.</p>
</dd>
<dt><a class="reference internal" href="#module-mvpy.model_selection.shapley_score" title="mvpy.model_selection.shapley_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.shapley_score</span></code></a></dt><dd><p>A shorthand for fitting this class.</p>
</dd>
<dt><a class="reference internal" href="../modules/generated/mvpy.crossvalidation.Validator.html#mvpy.crossvalidation.Validator" title="mvpy.crossvalidation.Validator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.crossvalidation.Validator</span></code></a></dt><dd><p>The cross-validation object required by <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shapley</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>All entries of scores are relative to the baseline group, except for, of course, 
the baseline group itself.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If multiple values are supplied for <code class="docutils literal notranslate"><span class="pre">metric</span></code>, this class will
produce a dictionary of <code class="docutils literal notranslate"><span class="pre">{Metric.name:</span> <span class="pre">score,</span> <span class="pre">...}</span></code> rather than
a stacked array. This is to provide consistency across cases where
metrics may or may not differ in their output shapes.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_meeg_continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeDelayed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.crossvalidation</span><span class="w"> </span><span class="kn">import</span> <span class="n">Validator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">Shapley</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_meeg_continuous</span><span class="p">(</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup pipeline for estimation of multivariate temporal response functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trf</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Scaler</span><span class="p">()</span><span class="o">.</span><span class="n">to_torch</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">TimeDelayed</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> 
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">alphas</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup validator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">validator</span> <span class="o">=</span> <span class="n">Validator</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">trf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup groups</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">],</span> 
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">long</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># score individual predictors using Shapley</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapley</span> <span class="o">=</span> <span class="n">Shapley</span><span class="p">(</span><span class="n">validator</span><span class="p">,</span> <span class="n">n_permutations</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapley</span><span class="o">.</span><span class="n">score_</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([10, 3, 5, 64, 400])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mvpy.model_selection.shapley.Shapley.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#mvpy.model_selection.shapley.Shapley" title="mvpy.model_selection.shapley.Shapley"><span class="pre">Shapley</span></a></span></span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/shapley.py#L350"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.shapley.Shapley.fit" title="Link to this definition">#</a></dt>
<dd><p>Fit the models to obtain Shapley values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The input data of arbitray shape.</p>
</dd>
<dt><strong>y</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The output data of arbitrary shape.</p>
</dd>
<dt><strong>groups</strong><span class="classifier">Optional[List | np.ndarray | torch.Tensor], default=None</span></dt><dd><p>Matrix describing all groups of interest of shape <code class="docutils literal notranslate"><span class="pre">(n_groups,</span> <span class="pre">n_predictors)</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will default to the identity matrix of <code class="docutils literal notranslate"><span class="pre">(n_predictors,</span> <span class="pre">n_predictors)</span></code>.</p>
</dd>
<dt><strong>dim</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>The dimension in <span class="math notranslate nohighlight">\(X\)</span> that describes the predictors. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will assume <code class="docutils literal notranslate"><span class="pre">-1</span></code> for 2D data and <code class="docutils literal notranslate"><span class="pre">-2</span></code> otherwise.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>shapley</strong><span class="classifier">mvpy.model_selection.Shapley</span></dt><dd><p>The fitted shapley model selector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mvpy.model_selection.shapley.fit_permutation_">
<span class="sig-prename descclassname"><span class="pre">mvpy.model_selection.shapley.</span></span><span class="sig-name descname"><span class="pre">fit_permutation_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mvpy.crossvalidation.html#mvpy.crossvalidation.validator.Validator" title="mvpy.crossvalidation.validator.Validator"><span class="pre">Validator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/shapley.py#L64"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.shapley.fit_permutation_" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mvpy.model_selection.shapley.fit_validator_">
<span class="sig-prename descclassname"><span class="pre">mvpy.model_selection.shapley.</span></span><span class="sig-name descname"><span class="pre">fit_validator_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mvpy.crossvalidation.html#mvpy.crossvalidation.validator.Validator" title="mvpy.crossvalidation.validator.Validator"><span class="pre">Validator</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="mvpy.crossvalidation.html#mvpy.crossvalidation.validator.Validator" title="mvpy.crossvalidation.validator.Validator"><span class="pre">Validator</span></a></span></span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/shapley.py#L17"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.shapley.fit_validator_" title="Link to this definition">#</a></dt>
<dd><p>Fit an individual validator object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>validator</strong><span class="classifier">mvpy.crossvalidation.Validator</span></dt><dd><p>The validator object to be fit. Note that this is automatically cloned here.</p>
</dd>
<dt><strong>X</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The input data of arbitrary shape.</p>
</dd>
<dt><strong>y</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The output data of arbitrary shape.</p>
</dd>
<dt><strong>mask</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The mask to apply to the input data.</p>
</dd>
<dt><strong>dim</strong><span class="classifier">int</span></dt><dd><p>The dimension along which to apply the mask.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>validator</strong><span class="classifier">mvpy.crossvalidation.Validator</span></dt><dd><p>The fitted validator object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<p>Configure global settings and get information about the working environment.</p>
<p>The torch package contains data structures for multi-dimensional</p>
<p>Python part of the warnings subsystem.</p>
</section>
<section id="module-mvpy.model_selection.shapley_score">
<span id="mvpy-model-selection-shapley-score-module"></span><h2>mvpy.model_selection.shapley_score module<a class="headerlink" href="#module-mvpy.model_selection.shapley_score" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="mvpy.model_selection.shapley_score.shapley_score">
<span class="sig-prename descclassname"><span class="pre">mvpy.model_selection.shapley_score.</span></span><span class="sig-name descname"><span class="pre">shapley_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Pipeline</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BaseEstimator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="mvpy.metrics.html#mvpy.metrics.metric.Metric" title="mvpy.metrics.metric.Metric"><span class="pre">Metric</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="mvpy.metrics.html#mvpy.metrics.metric.Metric" title="mvpy.metrics.metric.Metric"><span class="pre">Metric</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_shapley</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_permutations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs_validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_validator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#mvpy.model_selection.shapley.Shapley" title="mvpy.model_selection.shapley.Shapley"><span class="pre">Shapley</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference external" href="https://github.com/FabulousFabs/mvpy/blob/79a5a24/mvpy/model_selection/shapley_score.py#L13"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mvpy.model_selection.shapley_score.shapley_score" title="Link to this definition">#</a></dt>
<dd><p>Implements a shorthand for Shapley scoring over all feature permutations in <span class="math notranslate nohighlight">\(X\)</span> describing <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>This function acts as a shorthand for <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shapley</span></code></a> 
where it will automatically create and fit all groups of predictors specified
in <span class="math notranslate nohighlight">\(X\)</span> following a shapley procedure. Returns either only the output scores
or, if <code class="docutils literal notranslate"><span class="pre">return_shapley</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, both the fitted shapley object and
the scores in a tuple.</p>
<p>For more information, please consult <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shapley</span></code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This performs <span class="math notranslate nohighlight">\(n k p\)</span> model fits where <span class="math notranslate nohighlight">\(n\)</span> is the number of permutations, <span class="math notranslate nohighlight">\(k\)</span> 
is the total number of cross-validation steps and <span class="math notranslate nohighlight">\(p\)</span> is the number of unique groups of
predictors. For large <span class="math notranslate nohighlight">\(p\)</span> or <span class="math notranslate nohighlight">\(n\)</span>, this becomes expensive to solve.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model</strong><span class="classifier">sklearn.pipeline.Pipeline | sklearn.base.BaseEstimator</span></dt><dd><p>The model to fit and score. Can be either a pipeline or estimator object.</p>
</dd>
<dt><strong>X</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The input data of arbitrary shape.</p>
</dd>
<dt><strong>y</strong><span class="classifier">np.ndarray | torch.Tensor</span></dt><dd><p>The output data of arbitrary shape.</p>
</dd>
<dt><strong>groups</strong><span class="classifier">Optional[List | np.ndarray | torch.Tensor], default=None</span></dt><dd><p>Matrix describing all groups of interest of shape <code class="docutils literal notranslate"><span class="pre">(n_groups,</span> <span class="pre">n_predictors)</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will default to the identity matrix <code class="docutils literal notranslate"><span class="pre">(n_predictors,</span> <span class="pre">n_predictors)</span></code>.</p>
</dd>
<dt><strong>dim</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>The dimension in <span class="math notranslate nohighlight">\(X\)</span> that describes the predictors. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will assume <code class="docutils literal notranslate"><span class="pre">-1</span></code> for 2D data and <code class="docutils literal notranslate"><span class="pre">-2</span></code> otherwise.</p>
</dd>
<dt><strong>cv</strong><span class="classifier">int | Any, default=5</span></dt><dd><p>The cross-validation procedure to follow. Either an object exposing a <code class="docutils literal notranslate"><span class="pre">split()</span></code> method, such as :py:class`~mvpy.crossvalidation.KFold`, or an integer specifying the number of folds to use in <code class="xref py py-class docutils literal notranslate"><span class="pre">KFold</span></code>.</p>
</dd>
<dt><strong>metric</strong><span class="classifier">Optional[mvpy.metrics.Metric, Tuple[mvpy.metrics.Metric]], default=None</span></dt><dd><p>The metric to use for scoring. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, this will default to the <code class="docutils literal notranslate"><span class="pre">score()</span></code> method exposed by <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p>
</dd>
<dt><strong>return_shapley</strong><span class="classifier">bool, default=True</span></dt><dd><p>Should the underlying <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shapley</span></code></a> object be returned?</p>
</dd>
<dt><strong>n_permutations</strong><span class="classifier">int, default=10</span></dt><dd><p>How many permutations should we run? A higher number of permutations yields better estimates. Generally, the higher the number of predictor groups, the higher the number of permutations used.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>How many jobs should be used to parallelise the hierarchical fitting procedure?</p>
</dd>
<dt><strong>n_jobs_validator</strong><span class="classifier">Optional[int], default=None</span></dt><dd><p>How many jobs should be used to parallelise the cross-validation procedure?</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">int | bool, default=False</span></dt><dd><p>Should progress be reported verbosely?</p>
</dd>
<dt><strong>verbose_validator</strong><span class="classifier">int | bool, default=False</span></dt><dd><p>Should progress in individual <a class="reference internal" href="../modules/generated/mvpy.crossvalidation.Validator.html#mvpy.crossvalidation.Validator" title="mvpy.crossvalidation.Validator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Validator</span></code></a> objects be reported verbosely?</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>shapley</strong><span class="classifier">Optional[mvpy.model_selection.Shapley]</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">return_shapley</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the underlying <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shapley</span></code></a> object.</p>
</dd>
<dt><strong>score</strong><span class="classifier">np.ndarray | torch.Tensor | Dict[str, np.ndarray] | Dict[str, torch.Tensor]</span></dt><dd><p>The all hierarchical scores of shape <code class="docutils literal notranslate"><span class="pre">(n_permutations,</span> <span class="pre">n_sets,</span> <span class="pre">n_cv[,</span> <span class="pre">...])</span></code> or a dictionary containing each individual <a class="reference internal" href="../modules/generated/mvpy.metrics.Metric.html#mvpy.metrics.Metric" title="mvpy.metrics.Metric"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metric</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#module-mvpy.model_selection.hierarchical_score" title="mvpy.model_selection.hierarchical_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.hierarchical_score</span></code></a>, <a class="reference internal" href="../modules/generated/mvpy.model_selection.Hierarchical.html#mvpy.model_selection.Hierarchical" title="mvpy.model_selection.Hierarchical"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.Hierarchical</span></code></a></dt><dd><p>An alternative scoring method computing the full permutation of feature combinations.</p>
</dd>
<dt><a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.model_selection.Shapley</span></code></a></dt><dd><p>The underlying shapley scoring object.</p>
</dd>
<dt><a class="reference internal" href="../modules/generated/mvpy.crossvalidation.Validator.html#mvpy.crossvalidation.Validator" title="mvpy.crossvalidation.Validator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mvpy.crossvalidation.Validator</span></code></a></dt><dd><p>The cross-validation objects used in <a class="reference internal" href="../modules/generated/mvpy.model_selection.Shapley.html#mvpy.model_selection.Shapley" title="mvpy.model_selection.Shapley"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shapley</span></code></a>.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>All entries of scores are relative to the baseline group, except for, of course, 
the baseline group itself.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If multiple values are supplied for <code class="docutils literal notranslate"><span class="pre">metric</span></code>, this class will
produce a dictionary of <code class="docutils literal notranslate"><span class="pre">{Metric.name:</span> <span class="pre">score,</span> <span class="pre">...}</span></code> rather than
a stacked array. This is to provide consistency across cases where
metrics may or may not differ in their output shapes.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When specifying <code class="docutils literal notranslate"><span class="pre">n_jobs</span></code> here, be careful not to specify any number of jobs
in the model or any <code class="docutils literal notranslate"><span class="pre">n_jobs_validator</span></code>. Otherwise, this will lead to a situation 
where individual jobs each try to initialise more low-level jobs, severely hurting 
performance.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_meeg_continuous</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.estimators</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeDelayed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">mvpy.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapley_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_meeg_continuous</span><span class="p">(</span><span class="n">fs</span> <span class="o">=</span> <span class="n">fs</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup pipeline for estimation of multivariate temporal response functions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trf</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">Scaler</span><span class="p">()</span><span class="o">.</span><span class="n">to_torch</span><span class="p">(),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">TimeDelayed</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> 
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">alphas</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># setup groups of predictors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">[</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">],</span> 
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># score predictors hierarchically</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapley</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">shapley_score</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">trf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">groups</span> <span class="o">=</span> <span class="n">groups</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">metric</span> <span class="o">=</span> <span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">r2</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.size([10, 4, 5, 64, 400])</span>
</pre></div>
</div>
</dd></dl>

<p>Configure global settings and get information about the working environment.</p>
<p>The torch package contains data structures for multi-dimensional</p>
</section>
<section id="module-mvpy.model_selection">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mvpy.model_selection" title="Link to this heading">#</a></h2>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mvpy.model_selection.hierarchical">mvpy.model_selection.hierarchical module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.hierarchical.Hierarchical"><code class="docutils literal notranslate"><span class="pre">Hierarchical</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.hierarchical.Hierarchical.fit"><code class="docutils literal notranslate"><span class="pre">Hierarchical.fit()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.hierarchical.check_dims_and_groups_"><code class="docutils literal notranslate"><span class="pre">check_dims_and_groups_()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.hierarchical.fit_validator_"><code class="docutils literal notranslate"><span class="pre">fit_validator_()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mvpy.model_selection.hierarchical_score">mvpy.model_selection.hierarchical_score module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.hierarchical_score.hierarchical_score"><code class="docutils literal notranslate"><span class="pre">hierarchical_score()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mvpy.model_selection.shapley">mvpy.model_selection.shapley module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.shapley.Shapley"><code class="docutils literal notranslate"><span class="pre">Shapley</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.shapley.Shapley.fit"><code class="docutils literal notranslate"><span class="pre">Shapley.fit()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.shapley.fit_permutation_"><code class="docutils literal notranslate"><span class="pre">fit_permutation_()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.shapley.fit_validator_"><code class="docutils literal notranslate"><span class="pre">fit_validator_()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mvpy.model_selection.shapley_score">mvpy.model_selection.shapley_score module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mvpy.model_selection.shapley_score.shapley_score"><code class="docutils literal notranslate"><span class="pre">shapley_score()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mvpy.model_selection">Module contents</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/source/mvpy.model_selection.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Fabian Schneider.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>